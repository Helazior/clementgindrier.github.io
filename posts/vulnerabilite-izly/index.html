<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Vulnerability in the QR Code of the Izly phone application - Helazior - Blog</title><meta name="Description" content="I&#39;ve reported and exploited a critical vulnerability in the Izly application that allows anyone to pay for a meal with just their phone number."><meta property="og:title" content="Vulnerability in the QR Code of the Izly phone application" />
<meta property="og:description" content="I&#39;ve reported and exploited a critical vulnerability in the Izly application that allows anyone to pay for a meal with just their phone number." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://helazior.github.io/posts/vulnerabilite-izly/" /><meta property="og:image" content="https://helazior.github.io/posts/vulnerabilite-izly/featured-image.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-14T23:14:56+01:00" />
<meta property="article:modified_time" content="2023-10-14T23:14:56+01:00" /><meta property="og:site_name" content="Blog" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://helazior.github.io/posts/vulnerabilite-izly/featured-image.png"/>
<meta name="twitter:title" content="Vulnerability in the QR Code of the Izly phone application"/>
<meta name="twitter:description" content="I&#39;ve reported and exploited a critical vulnerability in the Izly application that allows anyone to pay for a meal with just their phone number."/>
<meta name="application-name" content="Blog">
<meta name="apple-mobile-web-app-title" content="Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://helazior.github.io/posts/vulnerabilite-izly/" /><link rel="prev" href="https://helazior.github.io/posts/privacytests/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Vulnerability in the QR Code of the Izly phone application",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/helazior.github.io\/posts\/vulnerabilite-izly\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/helazior.github.io\/posts\/vulnerabilite-izly\/featured-image.png",
                            "width":  877 ,
                            "height":  438 
                        }],"genre": "posts","keywords": "vulnerability, computer science","wordcount":  1217 ,
        "url": "https:\/\/helazior.github.io\/posts\/vulnerabilite-izly\/","datePublished": "2023-10-14T23:14:56+01:00","dateModified": "2023-10-14T23:14:56+01:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Helazior","logo": "https:\/\/helazior.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Clément Gindrier"
            },"description": "I've reported and exploited a critical vulnerability in the Izly application that allows anyone to pay for a meal with just their phone number."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Helazior - Blog"><span class="header-title-pre"><i class='fa fa-home' aria-hidden='true'></i></span>Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/posts/vulnerabilite-izly/" selected>English</option><option value="/fr/posts/vulnerabilite-izly/">Français</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Helazior - Blog"><span class="header-title-pre"><i class='fa fa-home' aria-hidden='true'></i></span>Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/posts/vulnerabilite-izly/" selected>English</option><option value="/fr/posts/vulnerabilite-izly/">Français</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Vulnerability in the QR Code of the Izly phone application</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Clément Gindrier</a></span>&nbsp;<span class="post-category">included in <a href="/categories/article/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>article</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="14-10-2023">14-10-2023</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1217 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/vulnerabilite-izly/featured-image.png"
        data-srcset="/posts/vulnerabilite-izly/featured-image.png, /posts/vulnerabilite-izly/featured-image.png 1.5x, /posts/vulnerabilite-izly/featured-image.png 2x"
        data-sizes="auto"
        alt="/posts/vulnerabilite-izly/featured-image.png"
        title="I&#39;ve reported and exploited a critical vulnerability in the Izly application that allows anyone to pay for a meal with just their phone number." /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#vulnerability-in-the-qr-code-of-the-izly-phone-application">Vulnerability in the QR Code of the Izly phone application</a>
      <ul>
        <li><a href="#abstract-">Abstract :</a></li>
        <li><a href="#vulnerability-and-exploitation">Vulnerability and exploitation</a></li>
        <li><a href="#vulnerability-impact">Vulnerability impact</a></li>
        <li><a href="#proof-of-concept">Proof of Concept:</a></li>
        <li><a href="#patch">Patch</a></li>
        <li><a href="#conclusion">Conclusion</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="vulnerability-in-the-qr-code-of-the-izly-phone-application">Vulnerability in the QR Code of the Izly phone application</h2>
<p>By Clément Gindrier</p>
<p><a href="/posts/vulnerabilite-izly/paperIzlyTmp.pdf" rel=""><strong><i class="fas fa-book fa-fw" aria-hidden="true"></i>&nbsp;PDF version</strong></a></p>
<h3 id="abstract-">Abstract :</h3>
<p>Izly is a smartphone application for paying for meals in university restaurants in France. It is downloaded and used by millions of people.</p>
<p>The paper analyzes a critical vulnerability that I reported, as well as the patch that was applied. This zero-click vulnerability affected all phones, on all versions of the application, and made it possible to break the main functionality of the application without leaving any trace.
It allowed users to have all their meals paid for by other people using only their phone numbers, without them being able to do anything about it.</p>
<p>During my analysis, I was warned that other students had, 4 years earlier, found this vulnerability. This meant that it had been present for at least as long. Although The vulnerability had not been reported by these student.
I reported the vulnerability to the Izly developers on October 26, 2022 with the email: <code>support.izly@s-money.fr</code> which appears on the Play Store (no other contact is available on the site). Then, seeing that they didn&rsquo;t reply, I sent a report to ANSSI on December 1, 2022 via the email they gave on their site: <code>cert-fr@ssi.gouv.fr</code> with their PGP key, and they replied immediately. The vulnerability was corrected from April 15 to 26, 2023 with a forced update. Izly never contacted me for help or threats, but ANSSI confirmed that it was following my complaint that the application was patched.</p>
<p><figure><a class="lightgallery" href="/posts/vulnerabilite-izly/friseChronologique.png" title="Frise chronologique" data-thumbnail="/posts/vulnerabilite-izly/friseChronologique.png" data-sub-html="<h2>Frise chronologique</h2><p>Frise chronologique</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/vulnerabilite-izly/friseChronologique.png"
            data-srcset="/posts/vulnerabilite-izly/friseChronologique.png, /posts/vulnerabilite-izly/friseChronologique.png 1.5x, /posts/vulnerabilite-izly/friseChronologique.png 2x"
            data-sizes="auto"
            alt="/posts/vulnerabilite-izly/friseChronologique.png" width="3384" height="348" />
    </a><figcaption class="image-caption">Frise chronologique</figcaption>
    </figure></p>
<h3 id="vulnerability-and-exploitation">Vulnerability and exploitation</h3>
<p>An attacker can get someone else to pay for all his university restaurant meals, knowing only the victim&rsquo;s telephone number.</p>
<p>Needed for the attacker :</p>
<ul>
<li>
<p>The victim&rsquo;s telephone number</p>
</li>
<li>
<p>The victim must have enough money in his Izly account</p>
</li>
</ul>
<p>The attack is based on the fact that the QR Code generated by the Izly application to pay uses an HMAC as protection, which is never verified by the server. The QR Code is generated offline.</p>
<p>This means that the QR Code is not protected, and the text can be modified.</p>
<!-- raw HTML omitted -->
<p>QR Code text:</p>
<pre tabindex="0"><code class="language-cfscript" data-lang="cfscript">AIZ;                                 -&gt; QR Code type
33601234567;                         -&gt; editable phone number
2022-11-26 20:11:51;                 -&gt; Date and time of QR Code creation
3;                                   -&gt; QR Code type&#39;s Number
141739b44f3c79e8cdee7896b87b6d46f0a6e042 -&gt; HMAC of previous information
</code></pre><p>In conclusion, all you need to do is :</p>
<ul>
<li>
<p>Enter the victim&rsquo;s telephone number in the correct format (33 instead of 0 at the beginning).</p>
</li>
<li>
<p>Set the time at which you will pay (UTC+0), as the QR Code expires in a few minutes.</p>
</li>
<li>
<p>Set any HMAC, as it will not be checked. You can even leave it out.</p>
</li>
</ul>
<p>Then generate the QR Code, pass it in front of the scanner like a normal Izly QR Code, and the person with that number will pay.</p>
<p>The attack can be automated with an application that has the same interface as Izly&rsquo;s, for greater discretion.</p>
<h3 id="vulnerability-impact">Vulnerability impact</h3>
<p>Victim:</p>
<ul>
<li>
<p>Cannot protect herself against the attacks except by removing her money from the application and stopping using the application</p>
</li>
<li>
<p>She can only see the payment history to realize that she has lost money</p>
</li>
</ul>
<p>The attacker:</p>
<ul>
<li>
<p>He cannot be tracked, since no information about him is sent.</p>
</li>
<li>
<p>He can&rsquo;t be caught in the act, since at the checkout, only the victim&rsquo;s balance appears in addition to the receipt. No one can guess that he&rsquo;s not paying for himself.</p>
</li>
<li>
<p>The attack works without any action on the part of the victim.</p>
</li>
<li>
<p>All he needs is a telephone number containing money on the Izly account. He can try several numbers to see the remaining balance at the cash register.</p>
</li>
<li>
<p>Anyone can use the vulnerability in a matter of seconds, without any computer knowledge</p>
</li>
</ul>
<p>The vulnerability therefore seems critical.</p>
<p>Personally I don&rsquo;t know any victims or people who have complained about it. Although Izly hasn&rsquo;t communicated on it. So I don&rsquo;t know the real impact this vulnerability has had.</p>
<h3 id="proof-of-concept">Proof of Concept:</h3>
<p>I cannot do a demonstration here (although I&rsquo;ve done it before in university restaurants), but I can prove the bug with the code of the APK.</p>
<h4 id="application-code">Application code:</h4>
<p>The application&rsquo;s decompiled code with Jadx shows that the HMAC is generated with a key based on the number of QR Code creations by the user. However, we can generate QR Codes offline, and therefore locally, without any communication with the server. The server cannot therefore be aware of the key, and therefore of the hash. The information is therefore unprotected, as it cannot be verified by the server.</p>
<p><figure><a class="lightgallery" href="/posts/vulnerabilite-izly/GenQRCodeTexte.jpg" title="QR Code text generation function" data-thumbnail="/posts/vulnerabilite-izly/GenQRCodeTexte.jpg" data-sub-html="<h2>QR Code text generation function</h2><p>QR Code text generation function</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/vulnerabilite-izly/GenQRCodeTexte.jpg"
            data-srcset="/posts/vulnerabilite-izly/GenQRCodeTexte.jpg, /posts/vulnerabilite-izly/GenQRCodeTexte.jpg 1.5x, /posts/vulnerabilite-izly/GenQRCodeTexte.jpg 2x"
            data-sizes="auto"
            alt="/posts/vulnerabilite-izly/GenQRCodeTexte.jpg" width="1184" height="318" />
    </a><figcaption class="image-caption">QR Code text generation function</figcaption>
    </figure></p>
<p>Here we see that the HMAC key <code>key</code> line 11 is generated in the <code>Getkey</code> function line 2.</p>
<p><figure><a class="lightgallery" href="/posts/vulnerabilite-izly/GetKey.jpg" title="Key generation function" data-thumbnail="/posts/vulnerabilite-izly/GetKey.jpg" data-sub-html="<h2>Key text generation function</h2><p>Key generation function</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/vulnerabilite-izly/GetKey.jpg"
            data-srcset="/posts/vulnerabilite-izly/GetKey.jpg, /posts/vulnerabilite-izly/GetKey.jpg 1.5x, /posts/vulnerabilite-izly/GetKey.jpg 2x"
            data-sizes="auto"
            alt="/posts/vulnerabilite-izly/GetKey.jpg" width="1301" height="633" />
    </a><figcaption class="image-caption">Key text generation function</figcaption>
    </figure></p>
<p>We can see in the <code>GetKey</code> function that the <code>sharedPreferences</code> &ldquo;sharedPrefHotpCounter&rdquo; is retrieved, and will then be transformed a little to make it the key.</p>
<p><figure><a class="lightgallery" href="/posts/vulnerabilite-izly/sharedPrefInit.png" title="Initialize to 0" data-thumbnail="/posts/vulnerabilite-izly/sharedPrefInit.png" data-sub-html="<h2>Initialize to 0</h2><p>Initialize to 0</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/vulnerabilite-izly/sharedPrefInit.png"
            data-srcset="/posts/vulnerabilite-izly/sharedPrefInit.png, /posts/vulnerabilite-izly/sharedPrefInit.png 1.5x, /posts/vulnerabilite-izly/sharedPrefInit.png 2x"
            data-sizes="auto"
            alt="/posts/vulnerabilite-izly/sharedPrefInit.png" width="1193" height="24" />
    </a><figcaption class="image-caption">Initialize to 0</figcaption>
    </figure></p>
<p>The <code>sharedPreferences</code> &ldquo;sheredPrefHotpCounter&rdquo; is initialized to 0 here, then incremented by 1 each time a QR Code is created (in the function that generates the HMAC key).</p>
<p><figure><a class="lightgallery" href="/posts/vulnerabilite-izly/sharedPrefModif.png" title="Increment" data-thumbnail="/posts/vulnerabilite-izly/sharedPrefModif.png" data-sub-html="<h2>Increment</h2><p>Increment</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/posts/vulnerabilite-izly/sharedPrefModif.png"
            data-srcset="/posts/vulnerabilite-izly/sharedPrefModif.png, /posts/vulnerabilite-izly/sharedPrefModif.png 1.5x, /posts/vulnerabilite-izly/sharedPrefModif.png 2x"
            data-sizes="auto"
            alt="/posts/vulnerabilite-izly/sharedPrefModif.png" width="1227" height="18" />
    </a><figcaption class="image-caption">Increment</figcaption>
    </figure></p>
<p>These are the only places where this <code>sharedPreferences</code> is modified.</p>
<h4 id="tests-">Tests :</h4>
<p>It&rsquo;s possible to modify the hash, and even all the QR Code information as long as you remain consistent with the format, then regenerate the QR Code and see that it&rsquo;s still possible to pay. In this way, you can generate the entire QR Code with any number without needing the Izly application.</p>
<p>So I automated the process on a new Kotlin application with the same interface, choosing from my contacts who would pay.</p>
<h3 id="patch">Patch</h3>
<p>As of April 15, 2023, a forced update of Izly has been released fixing the vulnerability.<br>
QR Code text :</p>
<!-- raw HTML omitted -->
<pre tabindex="0"><code class="language-cfscript" data-lang="cfscript">AIZ; 										-&gt; QR Code type
a87f7661-7be9-4381-a423-67c238bb3dde; 		-&gt; UUID
2023-07-08 15:58:24; 						-&gt; Code creation date and time
3; 											-&gt; Code type number
73d9c0958d315640c90292c6e92f05920552d307;	-&gt; HmacSHA1 not checked

MEYCIQCcLB40kgofoTlawlX7RX4eMOig/dTrfJYdl   -&gt; Signature SHA256 with ECDSA
iJQpUSJEgIhAIfYfs0ovSErPdGloQ7gI61kG/atwV
sjmckX5hr+Uq5M							
</code></pre><p>2 lines have changed:</p>
<ul>
<li>the telephone number that identified the customer has been replaced by a version 4 UUID, i.e. a random number.</li>
<li>A new SHA256 signature with ECDSA has been added to guarantee data integrity.</li>
</ul>
<h4 id="reproduce-the-exploit">Reproduce the exploit</h4>
<p>To reproduce the exploit, we now need to know the victim&rsquo;s UUID and private key.
We can verify this by modifying the application used to exploit the previous vulnerability.
We recover our private key using the Frida tool, then reimplement the signature as Izly does, to obtain a valid QR Code again, according to openssl.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">lang</span><span style="color:#f92672">.</span><span style="color:#a6e22e">String</span> <span style="color:#a6e22e">signature</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@org.jetbrains.annotations.NotNull</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">lang</span><span style="color:#f92672">.</span><span style="color:#a6e22e">String</span> textToSign<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>                                  org<span style="color:#f92672">.</span><span style="color:#a6e22e">jetbrains</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotations</span><span style="color:#f92672">.</span><span style="color:#a6e22e">NotNull</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">lang</span><span style="color:#f92672">.</span><span style="color:#a6e22e">String</span> key<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    java<span style="color:#f92672">.</span><span style="color:#a6e22e">security</span><span style="color:#f92672">.</span><span style="color:#a6e22e">PrivateKey</span> privateKey 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">=</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">security</span><span style="color:#f92672">.</span><span style="color:#a6e22e">KeyFactory</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;EC&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> org<span style="color:#f92672">.</span><span style="color:#a6e22e">spongycastle</span><span style="color:#f92672">.</span><span style="color:#a6e22e">jce</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">.</span><span style="color:#a6e22e">provider</span><span style="color:#f92672">.</span><span style="color:#a6e22e">BouncyCastleProvider</span><span style="color:#f92672">())</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">.</span><span style="color:#a6e22e">generatePrivate</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">security</span><span style="color:#f92672">.</span><span style="color:#a6e22e">spec</span><span style="color:#f92672">.</span><span style="color:#a6e22e">PKCS8EncodedKeySpec</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>            android<span style="color:#f92672">.</span><span style="color:#a6e22e">util</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Base64</span><span style="color:#f92672">.</span><span style="color:#a6e22e">decode</span><span style="color:#f92672">(</span>key<span style="color:#f92672">,</span> 0<span style="color:#f92672">)));</span>
</span></span><span style="display:flex;"><span>    java<span style="color:#f92672">.</span><span style="color:#a6e22e">security</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Signature</span> signature <span style="color:#f92672">=</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">security</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Signature</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;SHA256withECDSA&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    signature<span style="color:#f92672">.</span><span style="color:#a6e22e">initSign</span><span style="color:#f92672">(</span>privateKey<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bytes <span style="color:#f92672">=</span> textToSign<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">(</span>p000<span style="color:#f92672">.</span><span style="color:#a6e22e">C2403pe</span><span style="color:#f92672">.</span><span style="color:#a6e22e">utf8</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    signature<span style="color:#f92672">.</span><span style="color:#a6e22e">update</span><span style="color:#f92672">(</span>bytes<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    java<span style="color:#f92672">.</span><span style="color:#a6e22e">lang</span><span style="color:#f92672">.</span><span style="color:#a6e22e">String</span> encodeToString <span style="color:#f92672">=</span> android<span style="color:#f92672">.</span><span style="color:#a6e22e">util</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Base64</span><span style="color:#f92672">.</span><span style="color:#a6e22e">encodeToString</span><span style="color:#f92672">(</span>signature<span style="color:#f92672">.</span><span style="color:#a6e22e">sign</span><span style="color:#f92672">(),</span> 2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> encodeToString<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>And then we check that the QR Code works by paying with it in a university restaurant. And it works.</p>
<p>To retrieve someone&rsquo;s UUID, we could:</p>
<ul>
<li>Take photo of the QR Code of someone</li>
<li>Hack Izly&rsquo;s database</li>
</ul>
<p>To recover someone&rsquo;s private key, we could:</p>
<ul>
<li>Have access one time to the account</li>
<li>Hack Izly&rsquo;s database</li>
</ul>
<p>Unless there are other vulnerabilities in private key generation, the patch seems effective.</p>
<p>The patch has also secured other parts of Izly. For example, it was previously possible to access developer API documentation at <a href="https://www.izly.com" target="_blank" rel="noopener noreffer ">https://www.izly.com</a>.</p>
<h3 id="conclusion">Conclusion</h3>
<p>This paper shows that vulnerabilities still exist in simple mechanisms, and that it is sometimes worth testing them.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 14-10-2023</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/posts/vulnerabilite-izly/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://helazior.github.io/posts/vulnerabilite-izly/" data-title="Vulnerability in the QR Code of the Izly phone application" data-hashtags="vulnerability,computer science"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://helazior.github.io/posts/vulnerabilite-izly/" data-hashtag="vulnerability"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://helazior.github.io/posts/vulnerabilite-izly/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://helazior.github.io/posts/vulnerabilite-izly/" data-title="Vulnerability in the QR Code of the Izly phone application" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/vulnerability/">vulnerability</a>,&nbsp;<a href="/tags/computer-science/">computer science</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/privacytests/" class="prev" rel="prev" title="Overview Of Privacytests.org"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Overview Of Privacytests.org</a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.116.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Clément Gindrier</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
